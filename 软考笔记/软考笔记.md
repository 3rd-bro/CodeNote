# 软考笔记

## 计算机硬件

### 计算机硬件组成

1. 计算机的基本硬件系统组成： **运算器、控制器、存储器、输入设备、输出设备**；*【理解+记忆+重要】*
2. CPU中央处理单元包括运算器、控制器，完成数据加工、逻辑运算、控制等；存储器是记忆设备，分为**内部存储器**和**外部存储器**；*【理解+记忆】*

### 中央处理单元

1. 功能：程序控制、操作控制、时间控制、数据处理，此外对系统内外部的中断做出响应；
2. 组成：运算器、控制器、寄存器、内部总线；
3. 运算器：**算术逻辑单元ALU（实现算术和逻辑运算）、累加寄存器AC（运算结果、源操作数的存放区）、数据缓冲寄存器DR（暂时存放内存的指令或数据）、状态条件寄存器PSW（保存指令运行结果的条件码内容，如溢出标志）**；*【理解+记忆】*
4. 算术运算：加减乘除；逻辑运算：与或非比较；
5. 控制器：**指令寄存器（暂存CPU执行指令）、程序计数器PC（存放指令执行地址）、地址寄存器AR（保存当前CPU所访问的内存地址）、指令译码器ID（分析指令操作码）**。控制整个CPU工作，最为重要；*【理解+记忆】*
6. CPU依据**指令周期不同阶段**区分二进制指令和数据，因为在指令周期不同阶段，指令会命令CPU分别去取指令或者数据；

### 校验码

1. 码距：两个编码从A变成B要改变的位数；【理解】
2. 奇偶校验码：定义、只能检错1位，不能纠错；【不考】
3. **CRC【理解+重要】：**
   1. **只能检错，不能纠错。一定能检查出来；**
   2. **思想：双方定义一个Gx，原始信息位后面追加若干校验位，使追加的信息能够被整除。接收方接收到带校验位的信息，然后用Gx整除。余数为0则没有错误。**
   3. **在原始信息为后面添加0 --> 多项式得到除数（x幂指数存在的位置为1，不存在为0） --> 生成CRC校验码（前两部相除，使用异或（模2）运算， 余数不足r个，前面用0补足） --> 生成最终信息串，将余数放到原始信息后 --> 接收方进行校验；**

### 指令系统

1. 计算机指令的组成：

   1. 一条指令由**操作码**和**操作数**两部分组成；
   2. 操作码决定要完成的操作；
   3. 操作数指参加运算的数据及其所在的单元地址；

2. 计算机指令的执行过程：

   1. **取指令** （**PC程序计数器** - 地址总线 - 指令寄存器IR） - （指令译码器）**分析指令** - **执行指令**（取出指令执行所需的源操作数）；

3. 指令寻址方式

   1. **顺序寻址方式（PC 一条接一条）**
   2. **跳跃寻址方式** （**不是都在PC里面**，这条指令直接给出， 例如b）

4. 指令操作数的寻址方式（考前3条）

   1. **立即寻址方式（地址码指的直接是操作数，不是地址）**
   2. **直接寻址方式（指令的地址字段给的是操作数的地址）**
   3. **间接寻址方式（指令的地址码给的是指向操作数的地址的地址（地址码是指针））**
   4. 寄存器寻址方式（地址码是寄存器编号）
   5. 基址寻址方式（基址寄存器的内容+地址码=操作数有效地址）
   6. 变址寻址方式（变址寄存器的内容+地址码=操作数有效地址）

5. 指令系统（中英文名字、实现方式）

   1. **CISC 复杂指令系统**， 兼容性强，指令多、长度可变，**微程序实现（微码）**；
   2. **RISC 精简指令系统**， 指令少， 使用频率接近， **硬件实现（硬布线裸机， 通用寄存器）**
   3. **SISD MISD ... 专业英语** Single Multiple Instruction Data

6. 流水线原理

   1. 将指令分成不同段，每段由不同部分去处理，因此加快效率（多条指令同时在不同部分同时运行）

7. RISC中的流水线技术：

   1. 超流水线技术 - 时间换取空间（细化流水、增加级数、提高主频，时间换空间）
   2. 超标量 - 安装多条流水线换取时间（空间换时间）
   3. 超长指令字，发挥软件作用（时间换空间)

8. ***流水线时间计算(注意时间单位)***

   1. ***流水线周期 --- 执行时间最长的一段（取析行最大的一个时间）***
   2. ***流水线执行时间：1条指令总执行时间按 + （总指令条数 - 1） * 流水线周期***
   3. ***流水线吞吐率计算： 指令条数 / 流水线执行时间***
   4. ***流水线的加速比计算：不使用的时间/使用流水线的时间***

   ![image-20240508013253074](./%E8%BD%AF%E8%80%83%E7%AC%94%E8%AE%B0.assets/image-20240508013253074.png)

### **存储系统**

1. **分级存储体系**，解决存储容量、成本和速度的矛盾问题；

   ![image-20240508014116717](./%E8%BD%AF%E8%80%83%E7%AC%94%E8%AE%B0.assets/image-20240508014116717.png)

2. **两级存储： Cache主存、 主存-辅存（虚拟存储体系）**

3. 局部性原理：CPU运行时，所访问的数据趋向于一个较小的局部空间地址，包括：

   1. **时间局部性原理**：如果一个数据正在被访问，近期很可能被再次方位，即在相邻时间里方位同一个数据项（想一下局部变量，短时间用了多次）；
   2. **空间局部性原理**：在最近的将来会用到的数据地址和现在访问的地址很可能是相近的，即相邻空间地址会被连续访问（想一下数组遍历）

4. 高速缓存Cache用来存储**当前最活跃的程序和数据，直接与CPU交互，位于CPU和主存之间**；

5. **Cache由控制部分和存储器组成，控制部分判断CPU的数据是否在Cache中，在则命中，不在则依据一定算法从主存中替换；**

6. **地址映射**：CPU工作时送出的是主存单元的地址，而应从Cache存储器中读写信息。所以需要将**主存地址转换位Cache存储器地址**，由硬件自动完成映射，分为3种方法：

   1. 直接映射，将Cache存储器等分成块，主存也等分成块并编号。主存中的块与 Cache中的块的对应关系是固定的，也即二者**块号相同**才能命中。地址变换简单但不灵活，容易造成资源浪费。
   2. 全相联映像：同样都等分成块并编号。主存中任意一块都与Cache中任意一块对应。因此可以随意调入Cache任意位置，但地址变换复杂，速度较慢。因为主存可以**随意调入**Cache任意块，只有当Cache满了才会发生块冲突，是**最不容易发生块冲突**的映像方式
   3. 组组相连映像：前面两种方式的结合，将Cache存储器先分块再分组，主存也同样先分块再分组，**组间采用直接映像**，即主存中组号与Cache中组号相同的组才能命中，但是**组内全相联映像**，也即组号相同的两个组内的所有块可以任意调换

7. 替换算法

   1. 替换算法的目标就是使**cache获得尽可能高的命中率**。常用算法有如下几种
      1. **随机替换算法**。就是用随机数发生器产生一个要替换的块号，将该块替换出去。
      2. **先进先出算法**。就是将最先进入Cache的信息块替换出去
      3. **近期最少使用算法**。这种方法是将近期最少使用的Cache中的信息块替换出去。
      4. **优化替换算法**。这种方法必须先执行一次程序，统计cache的替换情况有了这

8. **命中率及平均时间**（要会算平均时间）

   1. Cache有一个命中率的概念，即**当CPU所访问的数据在Cache中时，命中，直接从 Cache中读取数据**；
   2. 设读取一次Cache时间为1ns，若CPU访问的数据不在Cache中则需要从内存中读取，设读取一次内存的时间为1000ns，若在CPU多次读取数据过程中，有90%命中Cache，则CPU读取一次的平均时间为**(90%\*1+10%\*1000)ns**（不考虑先访问Cache再访问内存）

9. 磁盘结构和参数

   1. 磁盘有正反两个盘面，每个盘面有多个同心圆，每个同心圆是一个磁道，每个同心圆又被划分为多个扇区，数据就被存放在一个个**扇区**中；
   2. 磁头首先要寻找到对应的磁道，然后等待磁盘进行周期旋转，旋转到指定的扇
      区，才能读取到对应的数据，因此，会产生寻道时间和等待时间。公式为，***存取时间=寻道时间+等待时间（平均定位时间+转动延迟）***。
      注意：寻道时间是指磁头移动到磁道所需的时间：等待时间为等待读写的扇区转到磁头下方所用的时间。

10. 磁盘调度算法
    磁盘数据的读取时间分为**寻道时间+旋转时间**，也即先找到对应的磁道，而后再旋转到对应的扇区才能读取数据，其中**寻道时间耗时最长**，需要重点调度，有如下调度算法：
    1. **先来先服务FCFS**：根据进程请求访问同磁盘的先后顺序进行调度。
    2. **最短寻道时间优先SSTF**：请求访的磁道与当前磁道最近的进程优先调度，使得
       每次的寻道时间最短。**会产生“饥饿”现象，即远处进程可能永远无法访问**。
    3. **扫描算法SCAN**：又称“电梯算法”，磁头在磁盘上双向移动，其会选择离磁头当前所在磁道最近的请求访问的磁道，并且与磁头移动方向一致，磁头永远都是从重向外或者从外向重一直移动完才掉头，与电梯类似
    4. **单向扫描调度算法CSCAN**：与SCAN不同的是，其只做单向移动，即只能从里向外或者从外向重。

![image-20240508021404470](./%E8%BD%AF%E8%80%83%E7%AC%94%E8%AE%B0.assets/image-20240508021404470.png)

### 输入输出技术

1. 计算机系统中存在多种**内存与接口地址的编址方法**，常见的是下面两种：
   1. **内存与接口地址独立**编址方法
      **内存地址和接口地址是完全独立的两个地址空间**。访问数据时所使用的指令世完全不同，用于接口的指令只用于接口的读/写，其余的指令全都是用于内存的因此，在**编程序或读程序时很易使用和辨认**。这种编址方法的缺点是用于接口的**指令太少、功能太弱**；
   2. **内存与接口地址统一**编址方法
      内存地址和接口地址**统一在一个公共的地址空间**里，即**内存单元和接口共用地空间**。优点是原则上**用于内存的指令全都可以用于接口**，这就大大地增强了对接口的操作功能，而直在指令上也不再区分内存或接口指令。该编址方法的缺点就在于整个地址空间被分成两部分，其中一部分分配给接口使用，剩余的为内存所用，这**经常会导致内存地址不连续**；
2. 计算机和外设间的数据交互方式：
   1. **程序控制（查询）方式**：CPU主动查询**外设是否完成数据传输，效率极低**；
   2. **程序中断方式**：外设完成数据传输后，**向CPU发送中断**，等待CPU处理数据效率相对较高。**中断响应时间**指的是从发出中断请求到开始进入中断处理程序；**中断处理时间**指的是从中断处理开始到中断处理结束。**中断向量**提供中断服务程序的入口地址。多级中断嵌套，使用堆栈来保护断点和现场；
   3. **DMA方式（直接主存存取）**：**CPU只需完成必要的初始化等操作**，数据传输的整人过程都由**DMA控制器**来完成，在**主存和外设之间建立直接的数据通路**，效率很高；
   4. **在一个总线周期结束后，CPU会响应DMA请求开始读取数据；CPU响应程序中断方式请求是在一条指令执行结束时**；

### 总线结构

1. 总线（Bus），是指**计算机设备和设备之间传输信息的公共数据通道**。总线是连接计算机硬件系统内多种设备的通信线路，它的一个重要特征是由**总线上的所有设备共享**，因此可以将计算机系统内的多种设备连接到总线上；
2. 从广义上讲，任何连接两个以上电子元器件的导线都可以称为总线，通常分为以下三类：
   1. **内部总线**：内部芯片级别的总线，芯片与处理器之间通信的总线;
   2. **系统总线**：是板级总线，用于计算机内各部分之间的连接，具体分为**数据总线（并行数据传输位数）、地址总线（系统可管理的内存空间的大小）、控制总线（传送控制命令）(考点)**。代表的有ISA总线、EISA总线、PCI总;
   3. **外部总线**：设备一级的总线，**微机和外部设备的总线**。代表的有RS232（单行忌线）、SCSI（并行总线）、USB（通用串行总线，即插即用，支持热插拨）。



